using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;

namespace MalwareAnalysisGUI
{
    class PEiDTool : AnalysisEngineTool
    {
        const string EXEName = @"Resources\PEiD\PEiD.exe";

        private Process process;

        public PEiDTool()
        {
            this.Description = "PEiD";
        }

        public override void Analyze(Sample s)
        {

            Console.WriteLine(s.FileName);

            ProcessStartInfo psi = new ProcessStartInfo();
            psi.Arguments = " -hard " + s.FullPath;
            psi.FileName = EXEName;

            //psi.UseShellExecute = false;
            //psi.RedirectStandardOutput = true;

            process = Process.Start(psi);

            //StringBuilder sb = new StringBuilder();
            //while (process.HasExited == false)
            //{
            //    sb.Append(process.StandardOutput.ReadToEnd());
            //}

            //sb.Append(process.StandardOutput.ReadToEnd());

            //this.Result = sb.ToString();

        }


        public override void Dispose()
        {
            try
            {
                process.CloseMainWindow();
            }
            catch (Exception)
            {

            }
        }
    }
}
